# -*- coding: utf-8 -*-
"""data_cleaning.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1opHMurlOD6OS4PIP1mCgTInmqrXYo_pF
"""

import pandas as pd

# -------------------------------
# Team name normalization mapping
# -------------------------------
TEAM_MAPPING = {
    "Kings XI Punjab": "Punjab Kings",
    "Delhi Daredevils": "Delhi Capitals",
    "Royal Challengers Bangalore": "Royal Challengers Bengaluru",
    "Rising Pune Supergiant": "Rising Pune Supergiants"
}

# -------------------------------
# Clean batting dataset
# -------------------------------
def clean_batting_data(batting_df: pd.DataFrame) -> pd.DataFrame:
    """
    Cleans batting player-match dataset.
    - Converts date to datetime
    - Normalizes team names
    - Removes duplicate rows
    """

    df = batting_df.copy()

    # Ensure date format
    df['date'] = pd.to_datetime(df['date'], errors='coerce')

    # Normalize team names
    df['batting_team'] = df['batting_team'].replace(TEAM_MAPPING)
    df['opponent_team'] = df['opponent_team'].replace(TEAM_MAPPING)

    # Remove duplicates if any
    df = df.drop_duplicates()

    return df


# -------------------------------
# Clean bowling dataset
# -------------------------------
def clean_bowling_data(bowling_df: pd.DataFrame) -> pd.DataFrame:
    """
    Cleans bowling player-match dataset.
    - Converts date to datetime
    - Normalizes team names
    - Removes duplicate rows
    """

    df = bowling_df.copy()

    # Ensure date format
    df['date'] = pd.to_datetime(df['date'], errors='coerce')

    # Normalize team names
    df['bowling_team'] = df['bowling_team'].replace(TEAM_MAPPING)
    df['opponent_team'] = df['opponent_team'].replace(TEAM_MAPPING)

    # Remove duplicates if any
    df = df.drop_duplicates()

    return df