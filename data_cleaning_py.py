# -*- coding: utf-8 -*-
"""data_cleaning.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1k_mH6sj60cZ9Eo7CjNFRRIJLa4GRDHX2
"""

import pandas as pd


def load_data(file_path):
    """
    Load cricket dataset from CSV file.
    """
    return pd.read_csv(file_path)


def standardize_columns(df):
    """
    Convert column names to lowercase and replace spaces with underscores.
    """
    df = df.copy()
    df.columns = df.columns.str.strip().str.lower().str.replace(" ", "_")
    return df


def convert_dates(df):
    """
    Convert start_date column to datetime format.
    """
    df = df.copy()
    df["start_date"] = pd.to_datetime(
        df["start_date"],
        dayfirst=True,
        errors="coerce"
    )
    return df


def convert_numeric_columns(df):
    """
    Convert numeric columns and handle non-numeric values like 'DNB'.
    """
    df = df.copy()
    numeric_cols = ["runs", "mins", "bf", "4s", "6s", "sr"]

    for col in numeric_cols:
        df[col] = pd.to_numeric(df[col], errors="coerce")

    df[numeric_cols] = df[numeric_cols].fillna(0)
    return df


def handle_missing_values(df):
    """
    Handle missing categorical values.
    """
    df = df.copy()
    df["venue"] = df["venue"].fillna("Unknown")
    df["opposition"] = df["opposition"].fillna("Unknown")
    return df


def clean_cricket_data(file_path):
    """
    Complete data cleaning pipeline.
    """
    df = load_data(file_path)
    df = standardize_columns(df)
    df = convert_dates(df)
    df = convert_numeric_columns(df)
    df = handle_missing_values(df)
    return df