# -*- coding: utf-8 -*-
"""data_cleaning.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1b9CcK194E46-Y2HQch8zTZCr_pqcVou8
"""

import pandas as pd
from sklearn.preprocessing import MinMaxScaler
import os

# Create data folder if not exists
os.makedirs("data", exist_ok=True)

# Load datasets
matches = pd.read_csv("matches.csv")
deliveries = pd.read_csv("deliveries.csv")

# Merge datasets
df = deliveries.merge(matches, how="left", left_on="match_id", right_on="id")

# Handle missing values (future-proof)
df["venue"] = df["venue"].fillna("Unknown")
df["winner"] = df["winner"].fillna("No Result")
df["player_dismissed"] = df["player_dismissed"].fillna("None")
df = df.fillna(0)

# Date formatting
df["date"] = pd.to_datetime(df["date"], errors="coerce")

# Normalize numeric columns
scaler = MinMaxScaler()
df[["total_runs", "batsman_runs", "extra_runs"]] = scaler.fit_transform(
    df[["total_runs", "batsman_runs", "extra_runs"]]
)

# Save cleaned data
df.to_csv("data/ipl_cleaned.csv", index=False)

print(" Data cleaning completed and saved as data/ipl_cleaned.csv")